{
  "entities": {
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project within the MARCUS Automation Suite.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Project entity."
        },
        "projectName": {
          "type": "string",
          "description": "The name of the project."
        },
        "scopeOfWork": {
          "type": "string",
          "description": "A description of the work to be performed for the project."
        },
        "metroCodeId": {
          "type": "string",
          "description": "Reference to MetroCode. (Relationship: MetroCode 1:N Project)"
        },
        "contractorTypeId": {
          "type": "string",
          "description": "Reference to ContractorType. (Relationship: ContractorType 1:N Project)"
        },
        "estimatedBudget": {
          "type": "number",
          "description": "The estimated budget for the project."
        },
        "startDate": {
          "type": "string",
          "description": "The planned start date for the project.",
          "format": "date-time"
        },
        "technicalDocumentIds": {
          "type": "array",
          "description": "References to TechnicalDocuments. (Relationship: TechnicalDocument 1:N Project)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "projectName",
        "scopeOfWork",
        "metroCodeId",
        "contractorTypeId",
        "estimatedBudget",
        "startDate"
      ]
    },
    "MetroCode": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MetroCode",
      "type": "object",
      "description": "Represents a metro code used for project location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the MetroCode entity."
        },
        "code": {
          "type": "string",
          "description": "The metro code value."
        },
        "description": {
          "type": "string",
          "description": "A description of the metro area."
        }
      },
      "required": [
        "id",
        "code",
        "description"
      ]
    },
    "ContractorType": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContractorType",
      "type": "object",
      "description": "Represents a type of contractor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ContractorType entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the contractor type."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Contractor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Contractor",
      "type": "object",
      "description": "Represents a contractor available for projects.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Contractor entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the contractor."
        },
        "contactInformation": {
          "type": "string",
          "description": "Contact details for the contractor."
        },
        "contractorTypeId": {
          "type": "string",
          "description": "Reference to ContractorType. (Relationship: ContractorType 1:N Contractor)"
        },
        "metroCodeIds": {
          "type": "array",
          "description": "References to MetroCodes. (Relationship: MetroCode N:N Contractor)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "contactInformation",
        "contractorTypeId"
      ]
    },
    "EOIEmail": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EOIEmail",
      "type": "object",
      "description": "Represents an Expression of Interest (EOI) email sent to a contractor.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the EOIEmail entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N EOIEmail)"
        },
        "contractorId": {
          "type": "string",
          "description": "Reference to Contractor. (Relationship: Contractor 1:N EOIEmail)"
        },
        "sentDate": {
          "type": "string",
          "description": "The date and time the EOI email was sent.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the EOI email (e.g., sent, opened, replied)."
        }
      },
      "required": [
        "id",
        "projectId",
        "contractorId",
        "sentDate",
        "status"
      ]
    },
    "RFP": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RFP",
      "type": "object",
      "description": "Represents a Request for Proposal (RFP).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the RFP entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N RFP)"
        },
        "generatedDate": {
          "type": "string",
          "description": "The date the RFP was generated.",
          "format": "date-time"
        },
        "instructions": {
          "type": "string",
          "description": "The instructions for the RFP."
        }
      },
      "required": [
        "id",
        "projectId",
        "generatedDate",
        "instructions"
      ]
    },
    "Proposal": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Proposal",
      "type": "object",
      "description": "Represents a proposal submitted by a contractor in response to an RFP.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Proposal entity."
        },
        "rfpId": {
          "type": "string",
          "description": "Reference to RFP. (Relationship: RFP 1:N Proposal)"
        },
        "contractorId": {
          "type": "string",
          "description": "Reference to Contractor. (Relationship: Contractor 1:N Proposal)"
        },
        "submissionDate": {
          "type": "string",
          "description": "The date the proposal was submitted.",
          "format": "date-time"
        },
        "documentIds": {
          "type": "array",
          "description": "References to Documents related to the Proposal. (Relationship: Document 1:N Proposal)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "rfpId",
        "contractorId",
        "submissionDate"
      ]
    },
    "Scorecard": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Scorecard",
      "type": "object",
      "description": "Represents the scorecard for a proposal.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Scorecard entity."
        },
        "proposalId": {
          "type": "string",
          "description": "Reference to Proposal. (Relationship: Proposal 1:N Scorecard)"
        },
        "safetyScore": {
          "type": "number",
          "description": "The safety score assigned to the proposal."
        },
        "experienceScore": {
          "type": "number",
          "description": "The experience score assigned to the proposal."
        },
        "programmaticApproachScore": {
          "type": "number",
          "description": "The programmatic approach score assigned to the proposal."
        },
        "commercialExcellenceScore": {
          "type": "number",
          "description": "The commercial excellence score assigned to the proposal."
        },
        "innovativeSolutionsScore": {
          "type": "number",
          "description": "The innovative solutions score assigned to the proposal."
        },
        "missionCriticalExperienceScore": {
          "type": "number",
          "description": "The mission critical experience score assigned to the proposal."
        }
      },
      "required": [
        "id",
        "proposalId",
        "safetyScore",
        "experienceScore",
        "programmaticApproachScore",
        "commercialExcellenceScore",
        "innovativeSolutionsScore",
        "missionCriticalExperienceScore"
      ]
    },
    "AwardRecommendation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AwardRecommendation",
      "type": "object",
      "description": "Represents the award recommendation for a project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AwardRecommendation entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N AwardRecommendation)"
        },
        "contractorId": {
          "type": "string",
          "description": "Reference to Contractor. (Relationship: Contractor 1:N AwardRecommendation)"
        },
        "recommendationDate": {
          "type": "string",
          "description": "The date the award recommendation was made.",
          "format": "date-time"
        },
        "justification": {
          "type": "string",
          "description": "The justification for the award recommendation."
        }
      },
      "required": [
        "id",
        "projectId",
        "contractorId",
        "recommendationDate",
        "justification"
      ]
    },
    "Feedback": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Feedback",
      "type": "object",
      "description": "Represents feedback collected from stakeholders or contractors.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Feedback entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N Feedback)"
        },
        "userId": {
          "type": "string",
          "description": "Identifier of the user who provided the feedback (e.g., stakeholder or contractor). Note: This assumes you have a user management system."
        },
        "feedbackDate": {
          "type": "string",
          "description": "The date the feedback was provided.",
          "format": "date-time"
        },
        "comments": {
          "type": "string",
          "description": "The feedback comments."
        },
        "rating": {
          "type": "number",
          "description": "A rating associated with the feedback."
        }
      },
      "required": [
        "id",
        "projectId",
        "userId",
        "feedbackDate",
        "comments"
      ]
    },
    "TechnicalDocument": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TechnicalDocument",
      "type": "object",
      "description": "Represents a technical document related to a project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the TechnicalDocument entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the document."
        },
        "url": {
          "type": "string",
          "description": "The URL or path to the document.",
          "format": "uri"
        },
        "uploadDate": {
          "type": "string",
          "description": "The date the document was uploaded.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "url",
        "uploadDate"
      ]
    },
    "Document": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Document",
      "type": "object",
      "description": "Represents a generic document, potentially associated with various entities.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Document entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the document."
        },
        "url": {
          "type": "string",
          "description": "The URL or path to the document.",
          "format": "uri"
        },
        "uploadDate": {
          "type": "string",
          "description": "The date the document was uploaded.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "url",
        "uploadDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/metro_codes/{metroCodeId}",
        "definition": {
          "entityName": "MetroCode",
          "schema": {
            "$ref": "#/backend/entities/MetroCode"
          },
          "description": "Stores metro codes. Publicly readable data.",
          "params": [
            {
              "name": "metroCodeId",
              "description": "The unique identifier of the metro code."
            }
          ]
        }
      },
      {
        "path": "/contractor_types/{contractorTypeId}",
        "definition": {
          "entityName": "ContractorType",
          "schema": {
            "$ref": "#/backend/entities/ContractorType"
          },
          "description": "Stores contractor types. Publicly readable data.",
          "params": [
            {
              "name": "contractorTypeId",
              "description": "The unique identifier of the contractor type."
            }
          ]
        }
      },
      {
        "path": "/contractors/{contractorId}",
        "definition": {
          "entityName": "Contractor",
          "schema": {
            "$ref": "#/backend/entities/Contractor"
          },
          "description": "Stores contractor information.  Access controlled based on system roles (e.g., admin can create/update).",
          "params": [
            {
              "name": "contractorId",
              "description": "The unique identifier of the contractor."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project details. Access controlled based on project membership (e.g., project members can read/write).",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/eoi_emails/{eoiEmailId}",
        "definition": {
          "entityName": "EOIEmail",
          "schema": {
            "$ref": "#/backend/entities/EOIEmail"
          },
          "description": "Stores Expression of Interest emails sent for a project. Includes denormalized 'projectId' for authorization independence.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            },
            {
              "name": "eoiEmailId",
              "description": "The unique identifier of the EOI email."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/rfps/{rfpId}",
        "definition": {
          "entityName": "RFP",
          "schema": {
            "$ref": "#/backend/entities/RFP"
          },
          "description": "Stores Request for Proposals for a project. Includes denormalized 'projectId' for authorization independence.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            },
            {
              "name": "rfpId",
              "description": "The unique identifier of the RFP."
            }
          ]
        }
      },
      {
        "path": "/rfps/{rfpId}/proposals/{proposalId}",
        "definition": {
          "entityName": "Proposal",
          "schema": {
            "$ref": "#/backend/entities/Proposal"
          },
          "description": "Stores proposals submitted for an RFP. Includes denormalized 'rfpId' for authorization independence.",
          "params": [
            {
              "name": "rfpId",
              "description": "The unique identifier of the RFP."
            },
            {
              "name": "proposalId",
              "description": "The unique identifier of the proposal."
            }
          ]
        }
      },
      {
        "path": "/proposals/{proposalId}/scorecards/{scorecardId}",
        "definition": {
          "entityName": "Scorecard",
          "schema": {
            "$ref": "#/backend/entities/Scorecard"
          },
          "description": "Stores scorecards for proposals. Includes denormalized 'proposalId' for authorization independence.",
          "params": [
            {
              "name": "proposalId",
              "description": "The unique identifier of the proposal."
            },
            {
              "name": "scorecardId",
              "description": "The unique identifier of the scorecard."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/award_recommendations/{awardRecommendationId}",
        "definition": {
          "entityName": "AwardRecommendation",
          "schema": {
            "$ref": "#/backend/entities/AwardRecommendation"
          },
          "description": "Stores award recommendations for projects. Includes denormalized 'projectId' for authorization independence.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            },
            {
              "name": "awardRecommendationId",
              "description": "The unique identifier of the award recommendation."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/feedback/{feedbackId}",
        "definition": {
          "entityName": "Feedback",
          "schema": {
            "$ref": "#/backend/entities/Feedback"
          },
          "description": "Stores feedback from users (stakeholders/contractors).  Path-based ownership for user access control.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user providing feedback."
            },
            {
              "name": "feedbackId",
              "description": "The unique identifier of the feedback."
            }
          ]
        }
      },
      {
        "path": "/technical_documents/{technicalDocumentId}",
        "definition": {
          "entityName": "TechnicalDocument",
          "schema": {
            "$ref": "#/backend/entities/TechnicalDocument"
          },
          "description": "Stores technical documents. Access controlled based on system roles.",
          "params": [
            {
              "name": "technicalDocumentId",
              "description": "The unique identifier of the technical document."
            }
          ]
        }
      },
      {
        "path": "/documents/{documentId}",
        "definition": {
          "entityName": "Document",
          "schema": {
            "$ref": "#/backend/entities/Document"
          },
          "description": "Stores generic documents.  Access controlled based on association (e.g., documents associated with a Proposal).",
          "params": [
            {
              "name": "documentId",
              "description": "The unique identifier of the document."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the MARCUS Automation Suite, emphasizing authorization independence, clarity, and scalability. It leverages path-based ownership for user-specific data and membership maps for collaborative data access.  Denormalization is used to ensure authorization independence and to optimize data reads, avoiding costly `get()` operations in security rules. The data structure is segregated to maintain a homogeneous security posture within each collection, and field naming is standardized for clarity.\n\n**Authorization Independence:**\nAuthorization independence is achieved primarily through denormalization. For instance, if access to EOIEmails needs to consider Project-level attributes, those attributes will be copied into the EOIEmail documents.\n\n**QAPs (Rules are not Filters):**\nThe design supports secure `list` operations by:\n\n1.  Segregating data with different access requirements into separate collections.  For example, `MetroCodes` and `ContractorTypes` which may have different read requirements than `Projects`.\n2.  Using path-based ownership where applicable (e.g., `/users/{userId}/feedback/{feedbackId}`), allowing simple rules to control access to user-owned data.\n3.  Using Membership Maps where data is collaborative.\n\nThe structure facilitates straightforward and robust security rules, minimizing complexity and ensuring that rules are not used as filters, which is a critical aspect of secure Firestore design."
  }
}